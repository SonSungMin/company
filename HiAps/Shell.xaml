<UserControl
    x:Class="Amisys.Framework.Presentation.AmiMainShell.Views.Shell"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:Amisys.Framework.Presentation.AmiMainShell"
    xmlns:prism="clr-namespace:Microsoft.Practices.Prism.Regions;assembly=Microsoft.Practices.Prism" 
    xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
    xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
    xmlns:dxd="http://schemas.devexpress.com/winfx/2008/xaml/docking"
    xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors"
    xmlns:dxnb="http://schemas.devexpress.com/winfx/2008/xaml/navbar"
    xmlns:dxr="http://schemas.devexpress.com/winfx/2008/xaml/ribbon"
    xmlns:extToolKit="clr-namespace:Xceed.Wpf.Toolkit;assembly=WPFToolkit.Extended"
    xmlns:infrastructure="clr-namespace:Amisys.Framework.Infrastructure;assembly=AmiAFInfrastructure"    
    Loaded="Window_Loaded"
    SnapsToDevicePixels="True" 
    UseLayoutRounding="True" 
    dx:ThemeManager.Theme="{Binding ThemeName}"
    Name="AmiMainShell" >
    <!--Closing="AmiMainShell_Closing" Icon="/HiAPS.ico" dx:ThemeManager.Theme="{Binding ThemeName}"-->
    <UserControl.Resources>
        <DataTemplate x:Key="BusyIndicatorDataTemplate">
            <StackPanel Margin="4">
                <TextBlock Text="Downloading Email" FontWeight="Bold" HorizontalAlignment="Center"/>
                <StackPanel Margin="4">
                    <TextBlock Text="Downloading message 4/10..."/>
                    <ProgressBar Value="40" Height="15"/>
                </StackPanel>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>
                    <Button Grid.Column="0" Content="Pause" HorizontalAlignment="Right" Margin="0 0 2 0"/>
                    <Button Grid.Column="1" Content="Cancel" HorizontalAlignment="Left" Margin="2 0 0 0"/>
                </Grid>
            </StackPanel>
        </DataTemplate>
        <Style x:Key="BusyIndicatorOverlayStyle" TargetType="Rectangle">
            <Setter Property="Fill" Value="#ffffeeee"/>
        </Style>
        <Style x:Key="BusyIndicatorProgressStyle" TargetType="ProgressBar">
            <Setter Property="Visibility" Value="Collapsed" />
        </Style>
    </UserControl.Resources>
              
    <extToolKit:BusyIndicator x:Name="MainBusyIndicator" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"
                              IsBusy="{Binding ElementName=AmiMainShell, Path=IsBusy}"
                              BusyContent="{Binding ElementName=AmiMainShell, Path=BusyContent}" 
                              MaxHeight="4000" MaxWidth="4000">

        
        <dxb:BarManager CreateStandardLayout="True" x:Name="parentBarManager"
                        DataContext="{Binding}"
                        ToolbarGlyphSize="{Binding ToolbarGlyphSize}">            
           
        <dxb:BarManager.Categories>
            <dxb:BarManagerCategory Name="Tools" />
        </dxb:BarManager.Categories>

        <dxb:BarManager.Items>
            
        </dxb:BarManager.Items>

        <dxb:BarManager.Bars>

                <dxb:Bar Caption="MainMenu" x:Name="MainMenu" IsMainMenu="True" UseWholeRow="True">
                    <dxb:Bar.DockInfo>
                        <dxb:BarDockInfo ContainerType="Top" ContainerName="{x:Null}" />
                    </dxb:Bar.DockInfo>
                </dxb:Bar>            
                <dxb:Bar x:Name="StatusBar"  Caption="Status Bar" IsStatusBar="True" UseWholeRow="True">
                    <dxb:Bar.DockInfo>
                        <dxb:BarDockInfo ContainerType="Bottom" ContainerName="{x:Null}" />
                    </dxb:Bar.DockInfo>
                    <dxb:Bar.ItemLinks>

                    </dxb:Bar.ItemLinks>
                </dxb:Bar>
            </dxb:BarManager.Bars>
            
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="0" Name="ShowMenuColumnDef" />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>
                <Button dx:ThemeManager.ThemeName="None" Name="ShowMenuButton" Width="22" VerticalAlignment="Top" Click="ShowMenuButton_Click">
                    <Image Source="../Images/Icons/OnOff.png" />
                </Button>
            <dxd:DockLayoutManager x:Name="dockManager" Grid.Column="1"
                                   DockItemActivated="dockManager_DockItemActivated"
                                   RedrawContentWhenResizing="False"
                               >
                
                <dxd:LayoutGroup>
                    <dxd:LayoutGroup>
                    <dxd:DocumentGroup Name="mdiContainer" MDIStyle="Default"
                                       DestroyOnClosingChildren="False" 
                                       ClosePageButtonShowMode="InActiveTabPageHeader" 
                                       SelectedTabIndex="0" 
                                       prism:RegionManager.RegionName="{x:Static infrastructure:MefRegionDefinition.MainRegion}"
                                       >                   
                    </dxd:DocumentGroup>
                </dxd:LayoutGroup>
                </dxd:LayoutGroup>
              
            </dxd:DockLayoutManager>
            </Grid>
        </dxb:BarManager>

       
    </extToolKit:BusyIndicator>
    </UserControl>
